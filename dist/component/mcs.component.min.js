!function(){"use strict";mcs.ng=mcs.ng||angular.module("mcs.ng",["mcs.ng.datatable","mcs.ng.uiCopy","mcs.ng.treeControl","mcs.ng.paging","dialogs.main"]),mcs.ng.constant("httpErrorHandleMessage",{404:"no file!",401:"unauthenticated access!",other:""}).service("httpErrorHandleService",function(a,b){var c=this;return c.process=function(a){var c=a.status+" "+a.statusText,d=a.data.message||a.data.description,e=a.data.messageDetail||a.data.stackTrace;b.error(c,d+"<\n>"+e)},this})}(),function(){"use strict";mcs.ng.filter("props",function(){return function(a,b){var c=[];if(angular.isArray(a)){var d=Object.keys(b);a.forEach(function(a){for(var e=!1,f=0;f<d.length;f++){var g=d[f],h=b[g].toLowerCase();if(-1!==a[g].toString().toLowerCase().indexOf(h)){e=!0;break}}e&&c.push(a)})}else c=a;return c}}),mcs.ng.filter("trusted",["$sce",function(a){return function(b){return a.trustAsHtml(b)}}]),mcs.ng.filter("normalize",function(){return function(a){return a&&"0001-01-01"!=a?a:""}})}(),function(){"use strict";mcs.ng.constant("buttonConfig",{categories:["add","edit","delete","search","view","save","cancel","ok","close","print","export","refresh","submit","approve","reject"],defaultTexts:["新 增","编 辑","删 除","查 询","查 看","保 存","取 消","确 定","关 闭","打 印","导 出","刷 新","提交审批","同 意","驳 回"],sizes:["mini","medium","large"],sizeCss:["btn-xs","btn-sm","btn-lg"],iconClass:["fa-plus","fa-pencil","fa-trash-o","fa-search","fa-eye","fa-save","fa-undo","fa-check","fa-times","fa-print","fa-share","fa-refresh","fa-arrow-right","fa-check-square","fa-undo"]}).directive("mcsDropdownButton",function(){return{restrict:"E",scope:{category:"@",css:"@",title:"@",items:"=",icon:"@"},templateUrl:mcs.app.config.mcsComponentBaseUrl+"/src/tpl/mcs-dropdown-button.tpl.html",replace:!0,link:function(a,b,c,d){a.category=a.category||"info",a.title=a.title||"新 增",a.icon?-1==a.icon.indexOf("fa-")&&(a.icon="fa-"+a.icon):a.icon="fa-plus",b.find("i").addClass(a.icon)}}}).directive("mcsButton",function(a){return{restrict:"E",scope:{category:"@",type:"@",text:"@",icon:"@",size:"@",css:"@",title:"&",click:"&"},template:'<button class="btn mcs-width-130" ng-click="click()"><i class="ace-icon fa bigger-110"></i><span></span></button>',replace:!0,link:function(b,c,d,e){c.attr("type",b.type||"button");var f=a.categories.indexOf(b.category),g="btn-info";switch(b.category){case"search":case"view":g="btn-primary";break;case"delete":g="btn-danger";break;case"save":case"ok":case"approve":g="btn-success";break;case"print":case"export":case"refresh":case"reject":g="btn-yellow";break;case"submit":g="btn-purple";break;case"cancel":case"close":g="btn-light"}if(c.addClass(g),b.size){var h=a.sizes.indexOf(b.size);c.addClass(a.sizeCss[h])}b.icon&&-1===f?0==b.icon.indexOf("fa-")?c.find("i").addClass(b.icon):c.find("i").addClass("fa-"+b.icon):c.find("i").addClass(a.iconClass[f]),b.css&&c.addClass(b.css),c.find("span").text(b.text||a.defaultTexts[f])}}})}(),function(){mcs.ng.directive("mcsCascadingSelect",["$http",function(a){return{restrict:"E",scope:{level:"@",caption:"@",data:"=?",model:"=",async:"@",url:"@",path:"@",root:"@",params:"=",otherParams:"=?",parentKey:"@",customStyle:"@?",callback:"&"},templateUrl:mcs.app.config.mcsComponentBaseUrl+"/src/tpl/mcs-cascading-select.tpl.html",replace:!0,controller:function(a){if(a.caption)a.level=mcs.util.toArray(a.caption).length;else{a.level=a.level||3,a.caption=[];for(var b=0;b<a.level;b++)a.caption.push("请选择")}switch(a.percentage="",a.level){case 1:a.portion=12;break;case 2:a.portion=6,a.percentage="mcs-select-width-50";break;case 3:default:a.portion=4,a.percentage="mcs-select-width-40";break;case 4:a.portion=3,a.percentage="mcs-select-width-30"}},link:function(b,c,d,e){b.path=mcs.util.bool(b.path||!1),b.root=b.root||"0",b.async=mcs.util.bool(b.async||!0),b.model=b.model||{},b.params=b.params||{},b.parentKey=b.parentKey||"parentKey";var f=function(c,d){if(d){if(mcs.util.bool(b.async)){if(!b.url)return;a({method:"post",url:b.url,data:b.params,cache:!0}).then(function(a){if(a.data){b.data=b.data||{};for(var e in a.data){var f=a.data[e];b.data[d]=b.data[d]||{},b.data[d][f.key]=f.value}g(c,b.data[d])}})}else{if("undefined"==typeof b.data[d])return!1;g(c,b.data[d])}c.select2("val","")}},g=function(a,b,c){if(b){var d=1,e=0;$.each(b,function(b,f){var g='<option value="'+b+'">'+f+"</option>";a.append(g),b==c&&(e=d),d++})}},h=mcs.util.toArray(b.caption);$.each(h,function(a,d){var e='<option value="">'+d+"</option>",g=c.find("select").eq(a);h.length,a==h.length-1;b.model[a]=g.val(),b.customStyle&&g.attr("style",b.customStyle),g.append(e).select2().change(function(){switch(b.model[a]=g.val(),b.model.selected=b.model.selected||{},b.$watch("$scope.model",b.callback),a){case 0:b.model.selected.key=g.val(),b.model.selected.value=g.select2("data").text;break;case 1:var d=c.find("select").eq(a-1);b.model.selected.key=d.val()+","+g.val(),b.model.selected.value=d.select2("data").text+","+g.select2("data").text;break;case 2:var d=c.find("select").eq(a-1),e=c.find("select").eq(a-2);b.model.selected.key=e.val()+","+d.val()+","+g.val(),b.model.selected.value=e.select2("data").text+","+d.select2("data").text+","+g.select2("data").text}if(!e){var i=c.find("select").eq(a+1);i.empty().append('<option value="">'+h[a+1]+"</option>");var j=g.val();if(b.path)switch(a){case 0:j=b.root+","+j;break;case 1:j=b.root+","+c.find("select").eq(a-1).val()+","+j;break;case 2:j=b.root+","+c.find("select").eq(a-2).val()+","+c.find("select").eq(a-1).val()+","+j}if(mcs.util.bool(b.async)&&g.val()){if(b.params[b.parentKey]=j,b.otherParams)for(var k in b.params)b.otherParams[k]&&(b.params[k]=b.otherParams[k]);f(i,j)}else f(i,j);i.change()}b.$apply("$scope.model")})}),f(c.find("select").eq(0),b.root)}}}])}(),function(){"use strict";mcs.ng.directive("mcsCheckboxGroup",function(){return{restrict:"E",scope:{data:"=",model:"="},template:'<label class="checkbox-inline" ng-repeat="item in data"><input type="checkbox" class="ace" ng-checked="model && model.indexOf(item.key)!=-1" ng-click="change(item, $event)"><span class="lbl"></span> {{item.value}}</label>',controller:function(a){a.change=function(b,c){mcs.util.setSelectedItems(a.model,b,c)}}}})}(),function(){angular.module("mcs.ng.paging",[]).controller("pagingController",function(a){}).directive("tmPagination",function(){return{restrict:"EA",template:'<div class="page-list"><ul class="pagination" ng-show="conf.totalCount > 0"><li ng-class="{disabled: conf.pageIndex == 1}" ng-click="prevPage()" style="cursor:pointer;"><span>&laquo;</span></li><li ng-repeat="item in pageList track by $index" ng-class="{active: item == conf.pageIndex, separate: item == \'...\'}" ng-click="changepageIndex(item)" style="cursor:pointer;"><span>{{ item }}</span></li><li ng-class="{disabled: conf.pageIndex == conf.numberOfPages}" ng-click="nextPage()" style="cursor:pointer;"><span>&raquo;</span></li></ul><div class="page-total" ng-show="conf.totalCount > 0">第 <input type="text" ng-model="jumpPageNum" class="mcs-input-small" ng-keypress="$event.keyCode == 13?jumpToPage($event):null" onkeyup="mcs.util.limit(this)" onafterpaste="mcs.util.limit(this)"/>页 共<strong> {{ conf.totalCount }} </strong>条记录 <button class="btn btn-minier btn-primary" ng-click="jumpToPage($event)"><i class="ace-icon fa bigger-110 fa-mail-forward"></i> 跳 转</button></div><div class="no-items" ng-show="conf.totalCount <= 0">暂无数据</div></div>',replace:!0,scope:{conf:"=",pageChange:"&"},link:function(a,b,c){function d(b,c){a.conf.pageIndex=parseInt(a.conf.pageIndex)?parseInt(a.conf.pageIndex):1,a.conf.totalCount=parseInt(a.conf.totalCount)?parseInt(a.conf.totalCount):0,a.conf.pageSize=parseInt(a.conf.pageSize)?parseInt(a.conf.pageSize):15,a.conf.numberOfPages=Math.ceil(a.conf.totalCount/a.conf.pageSize),a.conf.pageIndex<1&&(a.conf.pageIndex=1),a.conf.numberOfPages>0&&a.conf.pageIndex>a.conf.numberOfPages&&(a.conf.pageIndex=a.conf.numberOfPages),a.jumpPageNum=a.conf.pageIndex;for(var d,e=a.conf.perPageOptions.length,f=0;e>f;f++)a.conf.perPageOptions[f]==a.conf.pageSize&&(d=!0);if(d||a.conf.perPageOptions.push(a.conf.pageSize),a.conf.perPageOptions.sort(function(a,b){return a-b}),a.pageList=[],a.conf.numberOfPages<=a.conf.pagesLength)for(f=1;f<=a.conf.numberOfPages;f++)a.pageList.push(f);else{var g=(a.conf.pagesLength-1)/2;if(a.conf.pageIndex<=g){for(f=1;g+1>=f;f++)a.pageList.push(f);a.pageList.push("..."),a.pageList.push(a.conf.numberOfPages)}else if(a.conf.pageIndex>a.conf.numberOfPages-g){for(a.pageList.push(1),a.pageList.push("..."),f=g+1;f>=1;f--)a.pageList.push(a.conf.numberOfPages-f);a.pageList.push(a.conf.numberOfPages)}else{for(a.pageList.push(1),a.pageList.push("..."),f=Math.ceil(g/2);f>=1;f--)a.pageList.push(a.conf.pageIndex-f);for(a.pageList.push(a.conf.pageIndex),f=1;g/2>=f;f++)a.pageList.push(a.conf.pageIndex+f);a.pageList.push("..."),a.pageList.push(a.conf.numberOfPages)}}a.conf.onChange&&(c!=b&&0==c[0]||a.conf.onChange()),a.$parent.conf=a.conf}a.changepageIndex=function(b){"..."!=b&&(a.conf.pageIndex=b,a.pageChange())},a.conf.pagesLength=parseInt(a.conf.pagesLength)?parseInt(a.conf.pagesLength):9,a.conf.pagesLength%2===0&&(a.conf.pagesLength=a.conf.pagesLength-1),a.conf.perPageOptions||(a.conf.perPageOptions=[10,15,20,30,50]),a.prevPage=function(){a.conf.pageIndex>1&&(a.conf.pageIndex-=1,a.pageChange())},a.nextPage=function(){a.conf.pageIndex<a.conf.numberOfPages&&(a.conf.pageIndex+=1,a.pageChange())},a.jumpToPage=function(){a.jumpPageNum&&(a.conf.pageIndex=a.jumpPageNum,a.pageChange())},a.$watch(function(){a.conf.totalCount||(a.conf.totalCount=0);var b=a.conf.totalCount+" "+a.conf.pageIndex+" "+a.conf.pageSize;return b},d)}}})}(),function(){angular.module("mcs.ng.datatable",[]).controller("datatableController",function(a){a.paginationConf={currentPage:1,itemsPerPage:5,totalItems:20}}).directive("mcsDatatable",function(a){return{restrict:"E",templateUrl:mcs.app.config.mcsComponentBaseUrl+"/src/tpl/mcs-datatable.tpl.html ",replace:!0,scope:{data:"=",retrieveData:"&?",pageChanged:"&?"},link:function(a,b,c,d){if(a.data){a.retrieveData&&a.retrieveData().then(function(){a.reMatchRowsSelected()}),a.selectAll=function(){a.data.selectAll?a.data.rows.forEach(function(b){b.selected=!0;var c={};a.data.keyFields.forEach(function(a){c[a]=b[a]}),mcs.util.removeByObject(a.data.rowsSelected,c),a.data.rowsSelected.push(c)}):a.data.rows.forEach(function(b){b.selected=!1;var c={};a.data.keyFields.forEach(function(a){c[a]=b[a]}),mcs.util.removeByObject(a.data.rowsSelected,c)})},a.rowSelect=function(b){if(a.data.selectAll=!1,"radio"==a.data.selection){var c=a.data.rowsSelected[0]=a.data.rowsSelected[0]||{};a.data.keyFields.forEach(function(a){c[a]=b[a]}),b.selected=!0,a.data.rows.forEach(function(c){b[a.data.keyFields[0]]!=c[a.data.keyFields[0]]&&(c.selected=!1)})}else{var c={};a.data.keyFields.forEach(function(a){c[a]=b[a]}),b.selected?a.data.rowsSelected.push(c):mcs.util.removeByObject(a.data.rowsSelected,c)}},a.pageChange=function(b){b()&&b().then(function(){a.reMatchRowsSelected()})},a.reMatchRowsSelected=function(){var b=a.data.rowsSelected,c=a.data.rows,d=a.data.keyFields;if(0!=b.length&&0!=d.length&&0!=c.length)for(var e in b)for(var f in c){var g=0;for(var h in d)c[f][d[h]]==b[e][d[h]]&&(g+=1);g==d.length&&(c[f].selected=!0)}},a.reorder=function(b,c){b.orderDirection="asc"==b.orderDirection||void 0==b.orderDirection?"desc":"asc",b.sortable&&(a.onOrder&&angular.isFunction(a.onOrder())?a.onOrder({dataField:b.field,sortDirection:"asc"==b.orderDirection?0:1}):(a.data.orderBy[0].dataField=b.field,a.data.orderBy[0].sortDirection="asc"==b.orderDirection?0:1,c(),a.reMatchRowsSelected()))};var e=/click=['"]\w*/gi;a.data.headers.forEach(function(b,c){if(!b.field){var d=b.template&&b.template.match(e);d&&d.forEach(function(b){var c=b.replace('"',"'").split("'")[1];a[c]=a.$parent[c]})}})}}}}).directive("mcsDatatableRow",function(a){return{restrict:"A",link:function(b,c,d){var e=b.$parent.data.headers;b.row;b.vm=b.$parent.$parent.vm,e.forEach(function(d,e){var f=a('<td class="'+d.headerCss+'">'+(d.template||"<span>{{row."+d.field+"}}</span>")+"</td>")(b);c.append(f)})}}})}(),function(){"use strict";mcs.ng.service("mcsDialogService",["dialogs",function(a){var b=this;b.messageConfig={wait:{title:"操作中",message:"操作进行中，请稍后！"},info:{title:"消息",message:"操作发生错误"},error:{title:"错误",message:"操作发生错误，请重试或联系系统管理员！"},confirm:{title:"请确认",message:"确认进行此操作吗？"}},this.info=function(c){return c=jQuery.extend({title:b.messageConfig.info.title,message:b.messageConfig.info.message},c),a.notify(c.title,c.message)},this.confirm=function(c){return c=jQuery.extend({title:b.messageConfig.confirm.title,message:b.messageConfig.confirm.message},c),a.confirm(c.title,c.message)},this.error=function(c){return c=jQuery.extend({title:b.messageConfig.error.title,message:b.messageConfig.error.message},c),a.error(c.title,c.message)},this.wait=function(c){return c=jQuery.extend({title:b.messageConfig.wait.title,message:b.messageConfig.wait.message},c),a.wait(c.title,c.message)},this.create=function(b,c){return b?(c=jQuery.extend({controller:"",params:{},settings:{backdrop:"static",size:"md"},controllerAs:"vm"},c),a.create(b,c.controller,c.params,c.settings,c.controllerAs)):void 0}}])}(),function(){"use strict";mcs.ng.directive("mcsInput",["mcsValidationService",function(a){return{restrict:"E",replace:!0,scope:{id:"@",type:"@",placeholder:"@",readonly:"@",css:"@",customStyle:"@",datatype:"@",model:"="},template:'<input placeholder="{{placeholder}}" class="mcs-default-size-input mcs-margin-right-20 {{css}}" ng-model="model" style="{{customStyle}}"/>',link:function(b,c,d){var e=(b.datatype||"string").toLowerCase();b.id&&c.attr("id",b.id),"int"==e?c.bind("keyup afterpaste",function(){mcs.util.limit(c)}):"float"==e&&c.bind("keyup afterpaste",function(){mcs.util.number(c)}),c.attr("type",b.type||"text");var f=mcs.util.bool(b.readonly);f&&c.attr("disabled","disabled");var g=c.data("events");g&&g.blur||c.blur(function(){a.validate(c,b.$parent)})}}}])}(),function(){"use strict";mcs.ng.directive("mcsLabel",function(){return{restrict:"E",replace:!0,scope:{required:"@",text:"@",css:"@"},template:'<label class="control-label {{css}}"> {{text}}</label>',link:function(a,b,c){a.required&&b.prepend('<span class="required">*</span>'),a.css&&b.addClass(a.css)}}})}(),function(){mcs.ng.service("printService",function(){var a=this;return a.print=function(){var a=document.getElementById("printArea").cloneNode(!0),b=window.open(mcs.app.config.mcsComponentBaseUrl+"/src/mcs-print/mcs-print.html","","");b.opener=null,b.onload=function(){var c=b.document.getElementById("printContainer");c.appendChild(a)}},a})}(),function(){"use strict";mcs.ng.directive("mcsRadiobuttonGroup",function(){return{restrict:"E",scope:{data:"=",model:"=",value:"="},template:'<label class="radio-inline" ng-repeat="item in data" ng-show="item.state"><input name="{{groupName}}" type="radio" class="ace" ng-checked="item.key==model" ng-click="change(item)"><span class="lbl"></span> {{item.value}}</label>',controller:function(a){a.groupName=mcs.util.newGuid(),a.change=function(b){a.model=b.key,a.value=b.value}},link:function(a,b){b.attr("groupName",a.groupName)}}})}(),function(){"use strict";angular.module("mcs.ng.treeControl",[]).constant("treeSetting",{data:{key:{checked:"checked",children:"children",name:"name",title:"name"},simpleData:{enable:!0}},view:{selectedMulti:!0,showIcon:!0,showLine:!0,nameIsHTML:!1,fontCss:{}},check:{enable:!0},async:{enable:!0,autoParam:["id"],contentType:"application/json",type:"post"}}).directive("mcsTree",function(a,b){var c;return{restrict:"A",scope:{setting:"=mcsTree",setNodes:"&",distinctLevel:"@?"},link:function(b,d,e,f){var g=null,h=parseInt(b.distinctLevel);b.setting.getRawNodesChecked=function(){return c.getCheckedNodes(!0)},b.setting.clearChecked=function(){c.checkAllNodes(!1)},b.setting.justCheckWithinSameParent=function(a,c){return c.checked?(0==b.setting.getRawNodesChecked().length&&(g=null),!0):c.level>h?g?(g!=c.getParentNode()&&(b.setting.clearChecked(),g=c.getParentNode()),!0):(g=c.getParentNode(),!0):c.level==h?(g&&b.setting.clearChecked(),g=c.getParentNode(),!0):!1},b.setting.getNodesChecked=function(a){var b=[];return c.getCheckedNodes(!0).forEach(function(c,d){void 0==a||0==a?c.isParent||b.push({id:c.id,name:c.name,level:c.level}):b.push({id:c.id,name:c.name,level:c.level})}),b},b.setting.getNamesOfNodesChecked=function(a){var b=[];return c.getCheckedNodes(!0).forEach(function(c,d){void 0==a||0==a?c.isParent||b.push(c.name):b.push(c.name)}),b},b.setting.getIdsOfNodesChecked=function(a){var b=[];return c.getCheckedNodes(!0).forEach(function(c,d){void 0==a||0==a?c.isParent||b.push(c.id):b.push(c.id)}),b},angular.extend(a,b.setting),b.setNodes()(function(b){b&&(c=$.fn.zTree.init(d,a,b))})}}})}(),function(a){"use strict";angular.module("mcs.ng.uiCopy",[]).controller("uiCopyController",["$scope",function(){}]).directive("mcsUicopy",function(a,b){return{restrict:"E",scope:{data:"=",itemTemplateUrl:"@"},template:'<table style="width:100%" class="table-layout"><tr ng-repeat="row in data track by $index"><td><div ng-include="itemTemplateUrl"></div></td></tr></table>',link:function(a,b,c,d){}}})}(),function(){"use strict";mcs.ng.directive("fieldValidate",function(a,b){return{restrict:"A",require:"^form",scope:!0,link:function(a,c,d,e){var f=e.$name+"."+d.name,g=angular.element('<div class="errorMessage"></div>');a.$watchCollection(f,function(){if(e[d.name].$invalid&&!e[d.name].$pristine){c.attr("class","has-error");var a=b.validate(e,d.name);g.text(a)}}),c.after(g)}}}).service("dataValidateService",function(){var a=this;return a.errorMessages={required:"you have to input anything",minLength:"length too short",maxLength:"length too long"},a.validate=function(b,c){var d=b[c].$error;for(var e in d)if(d[e])return a.errorMessages[e]},a})}(),function(){"use strict";mcs.ng.service("mcsValidationService",["mcsValidationRules","mcsValidationMessageConfig","$parse",function(a,b,c){var d=this,e=function(a,c){var d=$.extend({errorMessage:b.general,validate:!0},c),e=a.closest(".form-group");if(e&&e.length){var f=e.find(".help-block");f&&f.length||(a.parent().append('<p class="help-block"></p>'),f=e.find(".help-block")),a.parent().hasClass("form-group")?d.validate?(e.removeClass("validate has-error"),f.text("").css("visibility","hidden")):(e.addClass("validate has-error"),f.text(d.errorMessage).css("visibility","visible")):d.validate?(a.parent().removeClass("has-error"),e.removeClass("validate"),f.text("").css("visibility","hidden")):(a.parent().addClass("has-error"),e.addClass("validate"),f.text(d.errorMessage).css("visibility","visible"))}else{var f=a.parent().find(".help-block");f&&f.length||(a.parent().append('<p class="help-block"></p>'),f=a.parent().find(".help-block")),d.validate?(a.removeClass("has-error"),a.parent().find(".control-label").removeClass("has-error"),f.removeClass("has-error").text("").css("visibility","hidden")):(a.addClass("has-error"),a.parent().find(".control-label").addClass("has-error"),f.text(d.errorMessage).css("visibility","visible"))}return a.attr("data-validate-result",d.validate),d.validate},f=function(b,c){var d=b?$("input, textarea",b):$("input, textarea");d.each(function(){var b=$(this);return b.is(":hidden")||b.is(":file")||b.closest(".form-group").is(":hidden")||!mcs.util.hasAttrs(b,a)?!0:void(mcs.util.hasAttr(b,"data-validate-result")||"function"==typeof c&&c(b))})};return d.validate=function(d,f){var g=!0;if(!mcs.util.hasAttrs(d,a))return g;if(g&&mcs.util.hasAttr(d,"required")&&(g=e(d,{errorMessage:d.attr("data-validation-required-message")||b.required,validate:$.trim(d.val()).length>0})),g&&mcs.util.hasAttr(d,"minlength")){var h=parseInt(d.attr("minlength"));h>0&&(g=e(d,{errorMessage:d.attr("data-validation-minlength-message")||mcs.util.format(b.minlength,h),validate:$.trim(d.val()).length>=h}))}if(g&&mcs.util.hasAttr(d,"maxlength")){var i=parseInt(d.attr("maxlength"));i>0&&(g=e(d,{errorMessage:d.attr("data-validation-maxlength-message")||mcs.util.format(b.maxlength,i),validate:$.trim(d.val()).length<=i}))}if(g&&mcs.util.hasAttr(d,"min")){var j=parseFloat(d.attr("min"));g=e(d,{errorMessage:d.attr("data-validation-min-message")||mcs.util.format(b.min,j),validate:parseFloat($.trim(d.val()))>=j})}if(g&&mcs.util.hasAttr(d,"max")){var k=parseFloat(d.attr("max"));g=e(d,{errorMessage:d.attr("data-validation-max-message")||mcs.util.format(b.max,k),validate:parseFloat($.trim(d.val()))<=k})}if(g&&mcs.util.hasAttr(d,"positive")&&(g=e(d,{errorMessage:d.attr("data-validation-positive-message")||b.positive,validate:"0"==$.trim(d.val())||/^[1-9]+[0-9]*$/.test($.trim(d.val()))})),g&&mcs.util.hasAttr(d,"negative")&&(g=e(d,{errorMessage:d.attr("data-validation-negative-message")||b.negative,validate:"0"==$.trim(d.val())||/^-[1-9]+[0-9]*$/.test($.trim(d.val()))})),g&&mcs.util.hasAttr(d,"number")&&(g=e(d,{errorMessage:d.attr("data-validation-number-message")||b.number,validate:/^(([1-9]\d*)|0)(\.\d+)?$/.test($.trim(d.val()))})),g&&mcs.util.hasAttr(d,"currency")&&(g=e(d,{errorMessage:d.attr("data-validation-currency-message")||b.currency,validate:/^(([1-9]\d*)|0)(\.\d{1,2})?$/.test($.trim(d.val()))})),g&&mcs.util.hasAttr(d,"less")){var l=parseFloat(d.attr("less"));g=e(d,{errorMessage:d.attr("data-validation-less-message")||mcs.util.format(b.less,l),validate:parseFloat($.trim(d.val()))>l})}if(g&&mcs.util.hasAttr(d,"great")){var m=parseFloat(d.attr("great"));g=e(d,{errorMessage:d.attr("data-validation-great-message")||mcs.util.format(b.great,m),validate:parseFloat($.trim(d.val()))<m})}if(g&&mcs.util.hasAttr(d,"between")){var n=d.attr("between").split(",");if(2==n.length){var j=parseFloat(n[0]),k=parseFloat(n[1]);isNaN(j)||isNaN(k)||(g=e(d,{errorMessage:d.attr("data-validation-between-message")||mcs.util.format(b.between,j,k),validate:parseFloat($.trim(d.val()))>=j&&parseFloat($.trim(d.val()))<=k}))}}return g&&mcs.util.hasAttr(d,"phone")&&(g=e(d,{errorMessage:d.attr("data-validation-phone-message")||b.phone,validate:/(^1[34578]\d{9}$)|(^\d{3,4}-\d{7,8}-\d{1,5}$)|(^\d{3,4}-\d{7,8}$)/.test($.trim(d.val()))})),g&&mcs.util.hasAttr(d,"email")&&(g=e(d,{errorMessage:d.attr("data-validation-email-message")||b.email,validate:/^[0-9a-z][_.0-9a-z-]{0,31}@([0-9a-z][0-9a-z-]{0,30}[0-9a-z]\.){1,4}[a-z]{2,4}$/.test($.trim(d.val()))})),g&&mcs.util.hasAttr(d,"idcard")&&(g=e(d,{errorMessage:d.attr("data-validation-idcard-message")||b.idcard,validate:/^(\d{18,18}|\d{15,15}|\d{17,17}x|\d{17,17}X)$/.test($.trim(d.val()))})),g&&mcs.util.hasAttr(d,"validate")?c(d.attr("validate"))(f):g},d.init=function(a,b){a.$on("$viewContentLoaded",function(c){f(b,function(b){b.blur(function(){d.validate(b,a)})})})},d.run=function(a){return f(a,function(a){a.blur()}),!$(".has-error").length},d}]).constant("mcsValidationRules",["required","minlength","maxlength","min","max","positive","negative","number","currency","great","less","between","phone","email","idcard","validate"]).constant("mcsValidationMessageConfig",{general:"输入数据项不正确，请重新输入!",required:"输入数据项为必填！",minlength:"应至少输入{0}个字符！",maxlength:"最多只能输入{0}个字符！",min:"输入数据项应大于或等于{0}！",max:"输入数据项应小于或等于{0}！",positive:"输入数据项应为正整数！",negative:"输入数据项应为负整数！",number:"输入数据项应为小数！",currency:"输入数据项应为货币值(最多保留两位小数)！",great:"输入数据项应小于{0}！",less:"输入数据项应大于{0}！",between:"输入数据项应在{0}和{1}之间！",phone:"输入数据项不是合法电话！",email:"输入数据项不是合法电子邮件！",idcard:"输入数据项不是合法身份证号！"})}();